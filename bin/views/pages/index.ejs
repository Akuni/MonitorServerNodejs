<!-- views/pages/index.ejs -->

<!DOCTYPE html>
<html lang="en">
<head>
    <% include ../partials/head %>
</head>
<body class="container">

<script src="http://canvasjs.com/assets/script/canvasjs.min.js"></script>
<script type="text/javascript">

var displayTemp = function (temp) {
    var array;
    for(var i = 0; i < temp.length ; i++){
        array[i] = {label = new Date(temp[i].timestamp).toLocaleString(), y: time[i].value.substring(6,10)};
    }

    var chart = new CanvasJS.Chart("chartContainer", {
        title:{
            text: "My First Chart in CanvasJS"              
        },
        data: [              
        {
            // Change type to "doughnut", "line", "splineArea", etc.
            type: "column",
            dataPoints: array
        }
        ]
    });
    chart.render();
}
</script>

    <header>
        <% include ../partials/header %>
    </header>

    <main>
        <div class="jumbotron">
            <h1>This is great</h1>
            <p>Welcome to templating using EJS</p>
        </div>

        <table class="custom_table">
            <tr>
                <td>
                    Date
                </td>
                <td>
                    Temp
                </td>
            </tr>
            <div id="chartContainer" style="height: 300px; width: 100%;"></div>
            <script>  
                var array = [];
                for(var i = 0; i < temp.length ; i++){
                    array[i] = {};
                    array[i].label =  new Date(temp[i].timestamp).toLocaleString();
                    array[i].y = templating[i].value.substring(6,10);
                }
                window.onload= function(){
                    var chart = new CanvasJS.Chart("chartContainer", {
                        title:{
                            text: "My First Chart in CanvasJS"              
                        },
                        data: [              
                        {
                            // Change type to "doughnut", "line", "splineArea", etc.
                            type: "line",
                            dataPoints: array
                        }
                        ]
                    });
                    chart.render(); 
                }
                </script>

            <% temp.forEach(function(t) { %>
                <tr>
                    <td>
                        <%= new Date(t.timestamp).toLocaleString() %>
                    </td>
                    <td> 
                        <%= t.value %>
                    </td>
                </tr>
            <% }); %>
        </table>
    </main>

    <footer>
        <% include ../partials/footer %>
    </footer>
    
</body>
</html>